#
# A Kubernetes manifest file for the configuration of the mirroring service.
#
# Author: David Hurta
#

apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: kafka-mirror
  name: kafka-mirror-configuration
data:
  mm2.properties: |
    # Documentation for fields can be found at https://kafka.apache.org/documentation/
    clusters = source, destination
    source.bootstrap.servers = kafka-edge:9092
    destination.bootstrap.servers = kafka-cloud:9092
    source->destination.enabled = true
    
    source->destination.topics = edge-server-.*
    
    replication.factor=1
    
    # To remove the cluster prefix generated by default by the MirrorMaker2
    replication.policy.class=org.apache.kafka.connect.mirror.IdentityReplicationPolicy
    
    # Needed to mirror new topics in a reasonable time
    refresh.topics.enabled=true
    refresh.topics.interval.seconds=5
              
    # Not necessarily needed for our demo application
    emit.heartbeats.enabled=true
    emit.checkpoints.enabled=true
    
    # Replication factors for internal topics          
    offset-syncs.topic.replication.factor=1
    offset.storage.replication.factor=1
    status.storage.replication.factor=1
    config.storage.replication.factor=1
    checkpoints.topic.replication.factor=1
    heartbeats.topic.replication.factor=1
